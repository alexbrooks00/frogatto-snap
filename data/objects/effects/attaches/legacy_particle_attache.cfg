{
id: "legacy_particle_attache",
prototype: ["effects_attache"],
zorder: "@include data/zorder.cfg:near_player_foreground_effects",
hidden_in_game: false,


types: {
	LegacyParticleSystemInfo: "{
		particle_system: [ParticleSystemData],

		id: string,
		prototype: [string],
		zorder: int,
		hidden_in_game: bool,
		types: map,
		properties: map,
	}",

	ParticleSystemData : "{
		animation: map|[map],
		id: string,
		max_x: int|null,
		max_y: int|null,
		min_x: int|null,
		min_y: int|null,
		
		delta_a: int|null,
		
		spawn_rate: int,
		time_to_live: int,
		type: string,
		
		velocity_x: int|null,
		velocity_x_random: int|null,
		velocity_y: int|null,
		velocity_y_random: int|null,
		velocity_magnitude: int|null,
		velocity_magnitude_random: int|null,
		velocity_rotate_random: int|null,
		
		
		accel_x: int|null,
		accel_y: int|null,
	}",

	SpawnRateData: "[{ name: string, rate: int }]",
},

properties: {
#-------------------------- effects_attache overrides --------------------------#
	/*
		We have a pretty shitty deal here where, upon loading from a save, in particular, most of these objects won't get constructed until their object actually ACTIVATES; not when it's actually created.  This may be a limitation of our available constructors from the engine;  I believe we have `on_start_level` as a level-wide broadcast that executes regardless of whether an object is active (in constrast with `on_create` which occurs only when first activated).   We don't have an equivalent for loading from saves, however, limiting us to only running constructors when first activated.   I believe the decision about how this worked was made during an era when everything in our objects was serializable 'no matter what', and in the intervening years since then, we've added several data types that aren't serializable, so objects need to be able to reconstruct themselves after loading from a save.
		
		This combines in a nasty way with how our particle system code works, where `particle_systems[name].whatever` is null until someone runs `add_particles(name)`.  One particular bad example of this lay in our `save_statue` objects, which would broadcast a signal to all other statues to turn themselves off; this would fail if said statues hadn't initialized yet.
		
		We may need to consider adding such an event to the engine; in the meantime we're putting a guard statement in here to block actions if we're trying to run them on an object that hasn't constructed yet.  If we run into situations where objects are mysteriously 'missing particles' after loading from a save, this may well be the culprit.
	*/


	assert_wrap: "def(commands do_stuff) -> commands execute(me,
		do_stuff
	) asserting size(particle_systems) > 0 | q(Looks like we had another instance of that bug where something tries to use a legacy particle attache without setting it up (critically, without spawning its particles).  The root object that spawned this is ${me.root_parent_object.type}.)",
	
	do_if_safe: "def(commands do_stuff) -> commands execute(me,
		if(me._constructed, do_stuff)
	)",
	
	
#-------------------------- effects_attache overrides --------------------------#
	do_setup: "execute(me, [
					initialize_position,
					map(particle_names, add_particles(value)),
				])",

	turn_on: "commands ::	do_if_safe([
								map(natural_spawn_rates, set(particle_systems[ value.name ].spawn_rate, value.rate)),
								apply_customizations_for_individual_usage,
								set(last_toggled_on, level.cycle),
							])",

	turn_off: "commands ::	do_if_safe([
								map(natural_spawn_rates, set(particle_systems[ value.name ].spawn_rate, 0)),
								set(last_toggled_off, level.cycle),
							])",



	handle_specialized_processing: "do_if_safe( customized_processing )",

#-------------------------- storage --------------------------#
	particle_names: { type: "[string]", default: [] },
	natural_spawn_rates: { type: "SpawnRateData", default: [] },
	last_toggled_on: { type: "int", default: 0 },
	last_toggled_off: { type: "int", default: 0 },


#-------------------------- vars --------------------------#
	_particle_type: {
		type: "string",
		set: "[
			set(_data, value),
			set(particle_names, types_for_name[value]),
			set(natural_spawn_rates,(SpawnRateData <- map(reduced_info, {name: value.id, rate: value.spawn_rate}))),
		]
			where reduced_info = filter(info.particle_system, 'iter', iter.id in types_for_name[value])
			where info = LegacyParticleSystemInfo <- get_document('data/objects/effects/attaches/legacy_particle_attache.cfg')",
			
	},



	types_for_name: "{ string -> [string] } :: {
		'bonfire': ['3_fire_bright', '2_fire_med', '1_fire_sparks'],
		'fire_bubbles': ['1_fire_bubbles_dark', '2_fire_bubbles_light'],
		'underwater_bubbles' : ['underwater_bubbles'],
		'test_case' : ['test_case'],
		'air_current': ['air_current'],
		'torch_flames': ['torch_flames'],
		'save_statue_fire': ['save_statue_fire'],
		'fountain_water_droplets': ['fountain_water_droplets'],
		'steam_small': ['steam_small'],
		'treasure_sparkle': ['treasure_sparkle'],
		'mana_cube_sparkles': ['mana_cube_sparkles'],
		'gazerlet_red_contrail': ['gazerlet_red_contrail'],
		'gazer_boss_zoomer_trail': ['gazer_boss_zoomer_trail'],
		'gazer_boss_gazerlet_seek_and_destroy_particles': ['gazer_boss_gazerlet_seek_and_destroy_particles'],
		'moth_big_burst': ['moth_big_burst'],
		'moth_big_trail': ['moth_big_trail'],
		'moth_small_burst': ['moth_small_burst'],
		'moth_small_trail': ['moth_small_trail'],
		'hortlebort_trail': ['hortlebort_trail', 'hortlebort_trail_light'],
		'hortlebort_burst': ['hortlebort_burst'],
		'hortlebort_body': ['hortlebort_body'],
		'white_forest_flower_small_trail': ['white_forest_flower_small_trail','white_forest_flower_small_trail_core'],
		'white_forest_flower_large_trail': ['white_forest_flower_large_trail','white_forest_flower_large_trail_core'],
		'white_forest_flower_small_burst': ['white_forest_flower_small_burst'],
		'prospera_spell_contrail': ['prospera_spell_contrail'],
		'prospera_spell_aftermath': ['prospera_spell_aftermath'],
		'fuse_sparks': ['fuse_sparks'],
		'energy_mote_contrail': ['blue_energy_motes_small', 'electric_sparks'],
		'arcane_mote_contrail': ['arcane_motes_small'],
		'energy_shot_contrail': ['energy_shot_contrail'],
		'arcane_shot_contrail': ['arcane_shot_contrail'],
		'acid_shot_contrail': ['acid_motes_small'],
		'fire_tongue_contrail': ['1_fire_sparks','2_fire_med', '0_fire_smoke', '3_fire_bright'],
		'smoky_fire_shot_contrail': ['2_fire_med', '0_fire_smoke'],
		'electric_sparks_dancing': ['electric_sparks', 'electric_sparks_small', 'blue_energy_motes_small'],
	}",

#-------------------------- vars for customization --------------------------#
	apply_customizations_for_individual_usage: "commands :: [
		if(customized_spawn_rects != null, 
			map(customized_spawn_rects, [
				set(particle_systems[ value.particle_id ].min_x, value.rect[0]),
				set(particle_systems[ value.particle_id ].max_x, value.rect[1]),
				set(particle_systems[ value.particle_id ].min_y, value.rect[2]),
				set(particle_systems[ value.particle_id ].max_y, value.rect[3]),
			])
		),


		if(customized_spawn_velocities != null, 
			map(customized_spawn_velocities, [
				set(particle_systems[ value.particle_id ].velocity_x,			value.numbers[0]),
				set(particle_systems[ value.particle_id ].velocity_x_random,	value.numbers[1]),
				set(particle_systems[ value.particle_id ].velocity_y,			value.numbers[2]),
				set(particle_systems[ value.particle_id ].velocity_y_random,	value.numbers[3]),
			])
		),

		
		if(customized_spawn_rates != null, 
			map(customized_spawn_rates, [
				set(particle_systems[ value.particle_id ].spawn_rate, value.magnitude),
			])
		),
		
		if(customized_times_to_live != null,
			map(customized_times_to_live, [
				set(particle_systems[ value.particle_id ].time_to_live, value.magnitude),
			])
		),
		
		/* 
			As needed, we could customize additional properties here - most likely velocity_x & y, etc.
			The spawn rect is overwhelmingly the primary thing we want to customize, though.
		*/
	]",

	customized_spawn_rects: { type: "[{ particle_id: string, rect: [int,int,int,int] }]|null", default: null },
	customized_spawn_velocities: { type: "[{ particle_id: string, numbers: [int,int,int,int] }]|null", default: null },
	customized_spawn_rates: { type: "[{ particle_id: string, magnitude: int }]|null", default: null },
	customized_times_to_live: { type: "[{ particle_id: string, magnitude: int }]|null", default: null },
	
	customized_spawn_rate_modulations: { type: "[{ particle_id: string, expression: function(obj legacy_particle_attache)->int }]|null", default: null },
	
	customized_processing: "if(customized_spawn_rate_modulations != null,
								map(customized_spawn_rate_modulations, [ 
									set(particle_systems[ value.particle_id ].spawn_rate, value.expression(me) )
								])
							)",
},



#-------------------------- particle definitions --------------------------#
	/*
		Originally, we wanted to do "external loading" of these - define every separate particle system in an individual file, and then load them in as-needed.  However, unlike our new particles that can be attached at runtime, these guys have to exist in the object at load time.  Because this is a general purpose object that's meant to allow us to attach *any* particle system to a target, it means we need to define every one we could hypothetically want to use, right here in this object, all together.
		
		Ironically, this may be just as good for perf as it is bad; we will take the hit of loading all particles in, but once they're loaded, they're likely to stay so.



		One technical note on layering:
		Particles are added in alphabetic order of ID.  Higher numbers are drawn last, and hence, on top.
		
		This only really matters for 'combined' effects like bonfire/fireplace visuals.
	*/


particle_system: [
	{
		id: "3_fire_bright",
		type: "simple",
		spawn_rate: 200,
		time_to_live: 12,
		min_x: -20,
		max_x: 20,
		min_y: -8,
		max_y: 8,
		velocity_y: -200,
		velocity_x: 260,
		velocity_x_random: 200,
		velocity_y_random: 400,
		accel_y: -5,

		animation: {
			id: "sparkle",
			image: "effects/explosion.png",
			x: 198,
			y: 145,
			w: 17,
			h: 16,
			pad: 3,
			frames: 6,
			frames_per_row: 2,
			reverse: true,
			scale: 2,
			duration: 2,
			accel_y: -5,
		},
	},
	{
		id: "2_fire_med",
		type: "simple",
		spawn_rate: 250,
		time_to_live: 96,
		min_x: -20,
		max_x: 20,
		min_y: -10,
		max_y: 10,
		velocity_y: -600,
		velocity_x: 260,
		velocity_x_random: 200,
		velocity_y_random: 1000,
		accel_y: -20,

		#color=255,255,255,255
		delta_a: 2,
		animation: {
			id: "sparkle",
			image: "effects/explosion.png",
			x: 105,
			y: 193,
			w: 13,
			h: 13,
			pad: 3,
			frames: 6,
			frames_per_row: 3,
			duration: 6,
		},
	},
	{
		id: "1_fire_sparks",
		type: "simple",
		spawn_rate: 75,
		time_to_live: 64,
		min_x: -20,
		max_x: 20,
		min_y: -20,
		max_y: 10,
		velocity_y: -600,
		velocity_x: 260,
		velocity_x_random: 200,
		velocity_y_random: 1000,
		accel_y: -30,

		animation: {
			id: "sparkle",
			image: "effects/explosion.png",
			x: 198,
			y: 86,
			w: 17,
			h: 16,
			pad: 3,
			frames: 6,
			frames_per_row: 2,
			scale: 2,
			duration: 4,
		},
	},
	{
		id: "0_fire_smoke",
		type: "simple",
		spawn_rate: 75,
		time_to_live: 40,
		min_x: -20,
		max_x: 20,
		min_y: -20,
		max_y: 10,
		velocity_y: -600,
		velocity_x: 260,
		velocity_x_random: 200,
		velocity_y_random: 1000,
		accel_y: -30,

		animation: {
			id: "sparkle",
			image: "effects/explosion.png",
			x: 198,
			y: 5,
			w: 17,
			h: 16,
			pad: 3,
			frames: 8,
			frames_per_row: 2,
			scale: 2,
			duration: 5,
			accel_y: -10,
		},
	},	
	{
		id: "1_fire_bubbles_dark",
		type: "simple",
		spawn_rate: 575,
		time_to_live: 12,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -200,
		velocity_x: -100,
		velocity_x_random: 200,
		velocity_y_random: 400,
		accel_y: -20,

		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 275,
			y: 485,
			w: 11,
			h: 11,
			pad: 3,
			frames: 6,
			frames_per_row: 3,
			scale: 2,
			duration: 2,
		},
	},
	{
		id: "2_fire_bubbles_light",
		type: "simple",
		spawn_rate: 100,
		time_to_live: 12,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -100,
		velocity_x: -100,
		velocity_x_random: 200,
		velocity_y_random: 200,
		accel_y: -10,

		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 275,
			y: 457,
			w: 11,
			h: 11,
			pad: 3,
			frames: 6,
			frames_per_row: 3,
			scale: 2,
			duration: 2,
		},
	},
	{
		id: "underwater_bubbles",
		type: "simple",
		spawn_rate: 75,
		time_to_live: 64,
		min_x: -45,
		max_x: 35,
		min_y: -20,
		max_y: 10,
		velocity_y: -600,
		velocity_x: -200,
		velocity_x_random: 200,
		velocity_y_random: 1000,
		accel_y: -30,

		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 62,
			y: 2,
			w: 10,
			h: 10,
			pad: 3,
			frames: 5,
			scale: 2,
			duration: 18,
		},
	},
	{
		id: "air_current",
		type: "simple",
		spawn_rate: 3000,
		time_to_live: 50,
		animation: {
			id: "sparkle",
			image: "effects/particles.png",
			x: 86,
			y: 3,
			w: 4,
			h: 4,
			pad: 3,
			frames: 5,
			duration: 10,
			accel_y: -1,
			scale: 2,
		},
	},	
	{
		id: "test_case",
		type: "simple",
		spawn_rate: 575,
		time_to_live: 12,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -200,
		velocity_x: -100,
		velocity_x_random: 200,
		velocity_y_random: 400,
		accel_y: -20,

		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 51,
			y: 423,
			w: 24,
			h: 24,
			pad: 3,
			frames: 1,
			scale: 2,
			duration: 2,
		},
	},
	{
		id: "torch_flames",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 55,
		min_x: 0,
		max_x: 0,
		min_y: 0,
		max_y: 0,
		velocity_y: -1000,
		velocity_x: -1000,
		velocity_x_random: 2000,
		velocity_y_random: 2000,
		accel_y: 1,
		animation: {
			id: "sparkle",
			image: "effects/explosion.png",
			x: 154,
			y: 193,
			w: 4,
			h: 4,
			pad: 3,
			frames: 5,
			scale: 2,
			duration: 10,
			accel_y: -1,
		},
	},
	{
		id: "save_statue_fire",
		type: "simple",
		spawn_rate: 750,
		time_to_live: 32,
		min_x: -2,
		max_x: 2,
		min_y: -1,
		max_y: 1,
		velocity_y: -1300,
		velocity_x: -100,
		velocity_x_random: 200,
		velocity_y_random: 600,
		accel_y: -2,
		animation: {
			id: "sparkle",
			image: "props/save_statue.png",
			rect: [33,1,46,14],
			frames: 8,
			frames_per_row: 4,
			duration: 4,
			pad: 3,
			palettes: "@include data/palettes.cfg:seaside_palettes + forest_palettes + cave_palettes",
		},
	},
	{
		id: "fountain_water_droplets",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 32,
		min_x: -22,
		max_x: 22,
		min_y: -2,
		max_y: 2,
		velocity_y: -2300,
		velocity_x: -2000,
		velocity_x_random: 4000,
		velocity_y_random: 600,
		accel_y: 230,
		animation: {
			id: "sparkle",
			image: "props/fountainC.png",
			rect: [2,117,5,120],
			frames: 8,
			duration: 4,
			pad: 3,
			palettes: "@include data/palettes.cfg:seaside_palettes + forest_palettes + cave_palettes",
		},
	},
	{
		id: "steam_small",
		type: "simple",
		spawn_rate: 200,
		time_to_live: 75,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -200,
		velocity_x: 200,
		velocity_x_random: 400,
		velocity_y_random: 400,
		accel_y: -40,
		accel_x: -6,

		delta_a: 1,
		animation: {
			id: "normal",
			image: "effects/particles.png",
			x: 3,
			y: 67,
			w: 9,
			h: 9,
			pad: 3,
			frames: 5,
			duration: 15,
			accel_y: -2,
		},
	},
	{
		id: "treasure_sparkle",
		type: "simple",
		min_y: -20,
		max_y: 20,
		min_x: -20,
		max_x: 20,
		spawn_rate: 10,
		time_to_live: 18,
		animation: [
			{
				id: "sparkle",
				image: "props/items.png",
				rect: [139,88,149,98],
				frames: 4,
				pad: 3,
				duration: 6,
			},
			{
					#same thing, but skip the first frame
				id: "sparkle",
				image: "props/items.png",
				rect: [153,88,163,98],
				frames: 3,
				pad: 3,
				duration: 4,
			},
			{
					#same thing, but skip the first 2 frames
				id: "sparkle",
				image: "props/items.png",
				rect: [167,88,177,98],
				frames: 2,
				pad: 3,
				duration: 6,
			},
		],
	},
	{
		id: "mana_cube_sparkles",
		type: "simple",
		min_y: -20,
		max_y: 20,
		min_x: -20,
		max_x: 20,
		spawn_rate: 200,
		time_to_live: 20,
		animation: [
			{
				id: "sparkle",
				image: "props/items.png",
				rect: [139,74,149,84],
				frames: 4,
				pad: 3,
				duration: 6,
			},
			{
					#same thing, but skip the first frame
				id: "sparkle",
				image: "props/items.png",
				rect: [153,74,163,84],
				frames: 3,
				pad: 3,
				duration: 4,
			},
			{
					#same thing, but skip the first 2 frames
				id: "sparkle",
				image: "props/items.png",
				rect: [167,74,177,84],
				frames: 2,
				pad: 3,
				duration: 6,
			},
			{
					#same thing, but skip the first 3 frames
				id: "sparkle",
				image: "props/items.png",
				rect: [181,74,191,84],
				frames: 1,
				pad: 3,
				duration: 6,
			},
		],
	},
	{
		id: "gazerlet_red_contrail",
		type: "simple",
		spawn_rate: 500,
		time_to_live: 40,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_magnitude: 100,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/gazer-grey-small.png",
			x: 235,
			y: 33,
			w: 15,
			h: 15,
			pad: 3,
			frames: 8,
			frames_per_row: 4,
			duration: 3,
		},
	},
	{
		id: "gazer_boss_zoomer_trail",
		type: "simple",
		spawn_rate: 4500,
		time_to_live: 7,
		min_x: -14,
		max_x: 14,
		min_y: -14,
		max_y: 14,
		velocity_magnitude: 100,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/gazer-boss-shot.png",
			x: 173,
			y: 0,
			w: 14,
			h: 14,
			pad: 0,
			frames: 6,
			frames_per_row: 3,
			duration: 1,
		},
	},
	{
		id: "gazer_boss_gazerlet_seek_and_destroy_particles",
		type: "simple",
		spawn_rate: 0,
		time_to_live: 24,
		min_x: -14,
		max_x: 14,
		min_y: -14,
		max_y: 14,
		velocity_magnitude: 600,
		velocity_magnitude_random: 300,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/gazer-boss-shot.png",
			rect: [128,0,142,14],
			frames: 6,
			frames_per_row: 3,
			reverse: true,
			pad: 0,
			duration: 6,
			//no_remove_alpha_borders: true,
		},
	},
	{
		id: "moth_big_burst",
		type: "simple",
		spawn_rate: 8000,
		time_to_live: 40,
		min_x: -1,
		max_x: 1,
		min_y: -1,
		max_y: 1,
		velocity_magnitude: 1000,
		velocity_magnitude_random: 500,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/moth-big.png",
			x: 191,
			y: 4,
			w: 7,
			h: 7,
			pad: 3,
			frames: 4,
			duration: 10,
		},
	},
	{
		id: "moth_big_trail",
		type: "simple",
		spawn_rate: 500,
		time_to_live: 40,
		min_x: -10,
		max_x: 10,
		min_y: -10,
		max_y: 10,
		velocity_magnitude: 100,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/moth-big.png",
			x: 191,
			y: 4,
			w: 7,
			h: 7,
			pad: 3,
			frames: 4,
			duration: 10,
		},
	},
	{
		id: "moth_small_burst",
		type: "simple",
		spawn_rate: 8000,
		time_to_live: 40,
		min_x: -1,
		max_x: 1,
		min_y: -1,
		max_y: 1,
		velocity_magnitude: 1000,
		velocity_magnitude_random: 500,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/moth-small.png",
			x: 151,
			y: 2,
			w: 5,
			h: 5,
			pad: 3,
			frames: 4,
			duration: 10,
		},
	},
	{
		id: "moth_small_trail",
		type: "simple",
		spawn_rate: 500,
		time_to_live: 40,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_magnitude: 100,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "enemies/moth-small.png",
			x: 151,
			y: 2,
			w: 5,
			h: 5,
			pad: 3,
			frames: 4,
			duration: 10,
		},
	},
	{
		id: "hortlebort_trail",
		type: "simple",
		spawn_rate: 400,
		time_to_live: 40,
		min_x: -8,
		max_x: 8,
		min_y: -3,
		max_y: 3,
		velocity_magnitude: 100,
		velocity_magnitude_random: 200,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 15,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 7,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 27,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 7,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 15,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 5,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 27,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 5,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 15,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 3,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 27,
			w: 9,
			h: 9,
			pad: 3,
			frames: 6,
			duration: 3,
		}],
	},
	{
		id: "hortlebort_trail_light",
		type: "simple",
		spawn_rate: 700,
		time_to_live: 50,
		min_x: -3,
		max_x: 3,
		min_y: -3,
		max_y: 3,
		velocity_magnitude: 250,
		velocity_magnitude_random: 300,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		}],
	},
	{
		id: "hortlebort_burst",
		type: "simple",
		spawn_rate: 8000,
		time_to_live: 40,
		min_x: -1,
		max_x: 1,
		min_y: -1,
		max_y: 1,
		velocity_magnitude: 1000,
		velocity_magnitude_random: 500,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		}],
	},
	{
		id: "hortlebort_body",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 40,
		min_x: -15,
		max_x: 15,
		min_y: -1,
		max_y: 10,
		velocity_magnitude: 200,
		velocity_magnitude_random: 700,
		velocity_rotate_random: 180,
		animation: [{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 4,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 39,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		},{
			id: "sparkle",
			image: "enemies/hortlebort-grey.png",
			x: 186,
			y: 47,
			w: 5,
			h: 5,
			pad: 3,
			frames: 7,
			duration: 7,
		}],
	},
	
	
	{
		id: "white_forest_flower_small_trail",
		type: "simple",
		spawn_rate: 700,
		time_to_live: 60,
		min_x: -3,
		max_x: 3,
		min_y: -3,
		max_y: 3,
		velocity_magnitude: 250,
		velocity_magnitude_random: 300,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 17,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 3,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 17,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 5,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 25,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 3,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 25,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 5,
		}],
	},
	{
		id: "white_forest_flower_small_trail_core",
		type: "simple",
		spawn_rate: 600,
		time_to_live: 40,
		min_x: -3,
		max_x: 3,
		min_y: -3,
		max_y: 3,
		velocity_magnitude: 50,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 1,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 2,
		}],
	},


	{
		id: "white_forest_flower_large_trail",
		type: "simple",
		spawn_rate: 1400,
		time_to_live: 60,
		min_x: -10,
		max_x: 10,
		min_y: -10,
		max_y: 10,
		velocity_magnitude: 250,
		velocity_magnitude_random: 300,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 17,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 3,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 17,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 5,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 25,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 3,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 25,
			w: 5,
			h: 5,
			pad: 3,
			frames: 12,
			duration: 5,
		}],
	},
	{
		id: "white_forest_flower_large_trail_core",
		type: "simple",
		spawn_rate: 1800,
		time_to_live: 40,
		min_x: -10,
		max_x: 10,
		min_y: -10,
		max_y: 10,
		velocity_magnitude: 50,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 1,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 2,
		}],
	},


	{
		id: "white_forest_flower_small_burst",
		type: "simple",
		spawn_rate: 8000,
		time_to_live: 50,
		min_x: -1,
		max_x: 1,
		min_y: -1,
		max_y: 1,
		velocity_magnitude: 700,
		velocity_magnitude_random: 600,
		velocity_rotate_random: 360,
		animation: [{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 1,
		},{
			id: "sparkle",
			image: "enemies/forest-shooting-plant.png",
			x: 149,
			y: 46,
			w: 7,
			h: 7,
			pad: 3,
			frames: 10,
			duration: 2,
		}],
	},

	{
		id: "prospera_spell_contrail",
		type: "simple",
		spawn_rate: 1500,
		time_to_live: 18,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_magnitude: 100,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "npc/prospera-spell.png",
			x: 0,
			y: 40,
			w: 12,
			h: 12,
			pad: 0,
			frames: 9,
			frames_per_row: 3,
			duration: 3,
		},
	},
	{
		id: "prospera_spell_aftermath",
		type: "simple",
		spawn_rate: 100,
		time_to_live: 18,
		min_x: -30,
		max_x: 30,
		min_y: -30,
		max_y: 30,
		velocity_magnitude: -300,
		velocity_magnitude_random: -600,
		velocity_rotate_random: 20,
		animation: {
			id: "sparkle",
			image: "npc/prospera-spell.png",
			x: 0,
			y: 40,
			w: 12,
			h: 12,
			pad: 0,
			frames: 9,
			frames_per_row: 3,
			duration: 3,
		},
	},
	{
		id: "fuse_sparks",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 6,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			rect: [6,30,12,36],
			frames: 3,
			duration: 2,
			pad: 4,
		},
	},
	{
		id: "blue_energy_motes",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 54,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: {
			id: "sparkle",
			image: "effects/particles5.png",
			rect: [193,97,221,125],
			frames: 9,
			duration: 6,
			pad: 3,
		},
	},
	{
		id: "blue_energy_motes_small",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 54,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: {
			id: "sparkle",
			image: "effects/particles5.png",
			rect: [321,97,349,125],
			frames: 5,
			duration: 6,
			pad: 3,
		},
	},
	{
		id: "arcane_motes_small",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 36,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: [{
			no_remove_alpha_borders: true,
			id: "normal",
			image: "effects/particles5.png",
			rect: [193,1,221,29], //light
			frames: 9,
			pad: 3,
			duration: 4,
			scale: 1,
		},{
			no_remove_alpha_borders: true,
			id: "normal",
			image: "effects/particles5.png",
			rect: [1,33,29,61], //dark
			frames: 9,
			pad: 3,
			duration: 4,
			scale: 1,
		}],
	},
	{
		id: "energy_shot_contrail",
		type: "simple",
		spawn_rate: 1000,
		time_to_live: 20,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_magnitude: 1000,
		velocity_magnitude_random: 1000,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 84,
			y: 19,
			w: 7,
			h: 7,
			pad: 3,
			frames: 4,
			scale: 2,
			duration: 5,
		},
	},
	{
		id: "arcane_shot_contrail",
		type: "simple",
		min_y: -6,
		max_y: 6,
		min_x: -6,
		max_x: 6,
		spawn_rate: 1000,
		time_to_live: 24,
		velocity_magnitude: 1000,
		velocity_magnitude_random: 100,
		velocity_rotate_random: 360,
		animation: {
			id: "sparkle",
			image: "effects/particles2.png",
			x: 1,
			y: 227,
			w: 7,
			h: 7,
			pad: 3,
			frames: 8,
			frames_per_row:4,
			scale: 2,
			duration: 3,
		},
	},	
	{
		id: "electric_sparks",
		type: "simple",
		spawn_rate: 150,
		time_to_live: 20,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: [{
			id: "sparkle",
			image: "effects/particles5.png",
			rect: [257,65,285,93],
			frames: 6,
			duration: 4,
			pad: 3,
		},{
			id: "sparkle",
			image: "effects/particles5.png",
			rect: [1,97,29,125],
			frames: 6,
			duration: 4,
			pad: 3,
		}],
	},
	{
		id: "electric_sparks_small",
		type: "simple",
		spawn_rate: 250,
		time_to_live: 20,
		min_x: -5,
		max_x: 5,
		min_y: -5,
		max_y: 5,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: [{
			"@base": true,
			id: "sparkle",
			image: "effects/electric-sparks1.png",
			rect: [1,1,31,20],
			frames: 13,
			pad: 2,
			duration: 1,
		},{
			rect: [1,23,31,42],
		},{
			rect: [1,30,31,64],
		},{
			rect: [1,67,31,86],
		},{
			rect: [1,89,31,108],
		},{
			rect: [1,111,31,130],
		}],
	},
	{
		id: "acid_motes_small",
		type: "simple",
		spawn_rate: 300,
		time_to_live: 36,
		min_x: -15,
		max_x: 15,
		min_y: -15,
		max_y: 15,
		velocity_y: -500,
		velocity_x: -500,
		velocity_x_random: 1000,
		velocity_y_random: 1000,
		animation: [{
			no_remove_alpha_borders: true,
			id: "normal",
			image: "effects/particles5.png",
			rect: [1,225,29,253],
			frames: 8,
			pad: 3,
			duration: 4,
		},{
			no_remove_alpha_borders: true,
			id: "normal",
			image: "effects/particles5.png",
			rect: [225,193,253,221],
			frames: 9,
			pad: 3,
			duration: 4,
		},{
			no_remove_alpha_borders: true,
			id: "normal",
			image: "effects/particles5.png",
			rect: [1,193,29,221],
			frames: 7,
			pad: 3,
			duration: 4,
		}],
	},
],
}
